#!/bin/sh

# This script is called from udev rules when udev detects a change in 
# monitor configuration. All xrandr commands are called to restore 
# the configuration. This is needed e.g. with document cameras that 
# cause displays to come and go on regular basis.
#
# udev rule example:
#
# ACTION=="change", SUBSYSTEM=="drm", RUN+="/usr/bin/udev-hotplug-monitor"

if pgrep -fx '/bin/sh /usr/lib/puavo-ltsp-client/puavo-desktop-session' \
  >/dev/null; then
   # There is a desktop session going on on this host.
   # The gnome-settings-daemon xrandr plugin should be taking care of the
   # displays, so do not mess with those here.
   exit 0
fi

export DISPLAY=:0.0
export XAUTHORITY=/var/run/lightdm/root/:0

/usr/lib/puavo-ltsp-client/puavo-run-xrandr
